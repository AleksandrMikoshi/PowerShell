# Часть Client

Содержимое папки располагается на сервере который используется для RemoteApp приложений, для возможности отображать [Windows Form.NET](https://learn.microsoft.com/ru-ru/dotnet/desktop/winforms/overview/?view=netdesktop-7.0), так как подключение к сесии [JEA](https://learn.microsoft.com/en-us/powershell/scripting/learn/remoting/jea/overview?view=powershell-7.3) не позволяет отображать окна в виду того что подключение происходит посредством сессии в PowerShell  

Для корректной работы на сервер с RemoteApp необходимо установить модуль PowerShell - [JiraPS](https://atlassianps.org/docs/JiraPS/)   

Далее в зависимости от настроек полей Jira необходимо указать свои поля в которых содержится информация необходимая для создания пользовательских учетных записей.   

## Необходимо самостоятельно указать

В файле [Start.ps1](https://github.com/AleksandrMikoshi/PowerShell/blob/main/Manage-Users/Client/Start.ps1) необходимо указать переменные:     

### Общие переменные
| Переменная         | Что необходимо указать                                                                    |
|---|---|
| $Mail_serv         | "Адрес почтового сервера для подключения по PowerShell"                                   |
| $DB                | "Название базы данных почтовых ящиков"                                                    |
| $Path_log          | "Расположение файла в котором будут писаться логи в случае ошибок"                        |
| $Path_OU           | "Путь в Active Directory где хранятся учетные записи пользователей"                       |
| $Path_fired        | "Путь в Active Directory где хранятся учетные записи уволеных пользователей"              |
| $Path_OU_Outstaff  | "Путь в Active Directory где хранятся учетные записи внешних пользователей"               |
| $Path_Mail         | "Путь в Active Directory где хранятся учетные записи почтовых адресов"                    |
| $Background_Image  | "Путь на диске где располагается изображение для заднего фона приложения"                 |  
| $Icon              | New-Object system.drawing.icon "Путь на диске где располагается изображение для иконки"   |
| $Label_Text        | "Название компании либо любая другая подпись снизу формы"                                 |
| $Cat               | "Путь на диске где располагается изображение для пункта 'Cat'"                            |

### Поля из Jira
Тут приведён пример моих полей Jira, в случае необходимости - надо заменить в функциях "Data_From_Jira.ps1" и "Data_From_Jira_Outstaff.ps1" на свои значения   

| Поле              | Что находится в поле                                                              |
|---|---|
| customfield_10501 | В этом поле располагается город в который выходит сотрудник (офис)                |
| customfield_10505 | В этом поле располагается дата рождения                                           |
| customfield_10708 | В этом поле располагается менеджер                                                |
| customfield_10408 | В этом поле располагается Фамилия Имя и Отчество сотрудника                       |
| customfield_10506 | В этом поле располагается будущий логин сотрудника                                |
| customfield_10410 | В этом поле раполагается должность сотрудника                                     |
| customfield_10502 | В этом поле располагается департамент куда выходит сотрудник                      |
| customfield_10700 | В этом поле располагается управление куда выходит сотрудник (необязательное поле) |
| customfield_10503 | В этом поле располагается номер телефона сотрудника                               |
| customfield_10409 | В этом поле располагается отдел куда выходит сотрудник                            |
| Key               | В этом поле располагается номер заявки                                            |
